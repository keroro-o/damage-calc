# damage-calc
このモジュールでは、ダメージ計算を行うことができます。  
ダメージ計算には

- ダメージ
- 防御
- 防御貫通

以上 3 つの整数値が与えられ、結果として実効ダメージが整数値として得られます。

計算アルゴリズムは以下のように定義されます。

- 負の入力値があった場合には0として扱い、2000以上の入力値は2000として扱う。
- 実効防御は、防御 - 防御貫通 で定義され、この実効防御は、0未満にはならない。
- ダメージ減少率は、実効防御 / (100 + 実効防御) で定義され、
  実効ダメージは、ダメージ * (1 - ダメージ減少率) を小数点以下で四捨五入した値となる。

## 使い方

```js
var dc = require('.');
console.log(dc.effectiveDamage(100, 50, 30));
```

以上を実行すると、

```
83
```

と表示されます。

以上の例では、ダメージは 100、防御が 50、防御貫通が30で定義されています。  
実効防御は、 50 - 30 で 20 となります。  
ダメージ減少率は、 20 / (100 + 20) であり、 1 / 6 です。
実効ダメージは、 100 * (1 - (1 / 6)) であり、 
計算すると 83.33333... となり、
小数点以下の四捨五入の結果、実効ダメージの 83 の値が得られます。

# テスティングフレームワーク
テストと言えばここまででは、Node.js の assert モジュールを利用したテストを行ってきた。しかし、この assert モジュールだけでは、テストをする際に不便な点がいくつかある。  
テストに必要な機能で言えば、下記のようなものがある。
  - テストを細かく分割する機能
  - テストに一つ一つに意味を付けて、実行結果の集計結果を表示する機能
  - テストの失敗の際に、どのような値が正解で実際はどのような値だったかを表示する機能
  - 細かく分割されたテストの最初と最後に、必ず実行する処理を集約する機能  
このような機能は、残念ながら assert モジュールには存在せず、自らで実装しなくてはいけない。このような便利な機能を予めとりそろえてくれ取り揃えてくれているのが、テスティングフレームワークである。

## ソフトウェアテストの種類
テスティングフレームワークで行えるソフトウェアテストには、  
  - モジュール単体をテストする、ユニットテスト
  - 複数のモジュールを結合して機能をテストする、結合テスト
  - システム全体が正しく動くことをテストする、システムテスト  
という３つのものが存在する。  
今回実践するのは、この中でもモジュール単体をテストする、ユニットテストである。このユニットテストでは、その外部に対して提供しているインタフェースの機能のみをテストしていき、テスティングフレームワークとしては、mocha というものを利用する。  
このように、モジュール内部の仕組みを意識することなく、外側のインタフェースからのみテストする手法をブラックボックステストという。

## mochaについて
  - Node.js には沢山のテスティングフレームワークがありますが、この mocha は、Node.js においてテストの実行結果を集計し、わかりやすく表示してくれる機能をもち合わせている。
  - mocha では、test/test.js というファイルがあると、自動的に実行してくれる。

